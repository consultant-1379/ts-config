{% raw -%}
#External values file
#Please set up the values regarding to deployment which you want to deploy
#In some variable values there are small-system and standard-system suggestion you can recognize it by comment {{small-system value|standard-system value}}
#The exact value for those variables is result of dimensioning exercise
#Please remove curly brackets {{}} surrounding the final value to set it right
{% endraw %}

global:
  #Possible deployments [small-system(ex. 10k), standard-system(ex. 1m), clear-text(ex. non-mtls), mtls]. Enable only one dimensioning profile and one security profile
  {% if jwtPolicy is defined %}
  jwtPolicy: {{ jwtPolicy|default("first-party-jwt") }}
  {% endif %}
  timezone: {{ timezone }}
  nrfagent:
    enabled: true #  true if CCDM is deployed in a solution where NRF is deployed, false otherwise.
  security:
    {% if caas == 'OpenShift' %}
    policyBinding:
      create: true
      defaultAdpBinding: true
    policyReferenceMap:
      default-restricted-security-policy: default-restricted-security-policy
      plc-privileged-for-istio: plc-privileged-for-istio
      plc-privileged-for-udr: plc-privileged-for-udr
      plc-privileged-for-adp: plc-privileged-for-adp
      plc-dd66cc53d8554f93ad34971900932e: plc-dd66cc53d8554f93ad34971900932e-wa
      plc-38dc0a0ee2b2564ef10039d2c6c0e0: plc-38dc0a0ee2b2564ef10039d2c6c0e0
      plc-59d0cf1dcc793a78b6ce30bfbe6553: plc-59d0cf1dcc793a78b6ce30bfbe6553
      plc-29c4b823c87a16cad810082eb11106: plc-29c4b823c87a16cad810082eb11106
      plc-1ef969b263a76b0a45e26d62f88e9b: plc-1ef969b263a76b0a45e26d62f88e9b
      plc-0c899a7ddf4aaf682c9c8c95791ea9: plc-0c899a7ddf4aaf682c9c8c95791ea9
    {% else %}
    policyBinding:
      create: false  # Default is false
      defaultAdpBinding: true
    policyReferenceMap:
      default-restricted-security-policy: default-restricted-security-policy
      plc-privileged-for-istio: plc-privileged-for-istio
      plc-privileged-for-udr: plc-privileged-for-udr
      plc-privileged-for-adp: plc-privileged-for-adp
      plc-privileged-for-swprobe: plc-privileged-for-swprobe
      plc-dd66cc53d8554f93ad34971900932e: plc-dd66cc53d8554f93ad34971900932e
      plc-e393f1841dfc4cbcca713b5a97eb83: plc-e393f1841dfc4cbcca713b5a97eb83
      plc-9c20871f9bf62c7b09fd0c684ac651: plc-9c20871f9bf62c7b09fd0c684ac651
      plc-38dc0a0ee2b2564ef10039d2c6c0e0: plc-38dc0a0ee2b2564ef10039d2c6c0e0
      plc-59d0cf1dcc793a78b6ce30bfbe6553: plc-59d0cf1dcc793a78b6ce30bfbe6553
      plc-03ad10577718e69c935814b4f30054: plc-03ad10577718e69c935814b4f30054
      plc-29c4b823c87a16cad810082eb11106: plc-29c4b823c87a16cad810082eb11106
      plc-1ef969b263a76b0a45e26d62f88e9b: plc-1ef969b263a76b0a45e26d62f88e9b
      plc-0c899a7ddf4aaf682c9c8c95791ea9: plc-0c899a7ddf4aaf682c9c8c95791ea9
    {% endif %}
  profiles:
    small-system:
      enabled: {{ 'true' if systemProfile == 'small' else 'false' }}
    standard-system:
      enabled: {{ 'true' if systemProfile == 'standard' else 'false' }}
    large-system:
      enabled: false
    cleartext:
      enabled: false
    mtls:
      enabled: true
  tapagent:
    pvtb:
      enabled: false #default is false
    egress_exclude_ips: "10.96.0.0/12,192.168.0.0/16"
    enabled: {{ 'false' if systemProfile == 'small' else 'true' }} #default shall be set to true
  {%- raw %}
#  domainName: {{DOMAIN-NAME}}
#  clusterName: {{NAMESPACE}}
  {% endraw %}
  enableCrashDumps: true
  ericsson:
    licensing:
      licenseDomains:
        - productType: "CCDM"
          customerId: "{{ license.customerId }}"
          swltId: "{{ license.swltId }}"
  licensing:
    sites:
      - hostname: {{ nels.host }}
        {%- raw %}
        #Remove the following comments to allow the IP and Priority configurations. IP will override the hostname configuration
        #ip: {{ip_address}}
        #priority: {{100}}
        {% endraw %}
  ipStackMode: "ipv4"
  #for supporting new pull secret levels
  pullSecret: regcred
  # global registry
  registry:
    url: {{ registry.url }}
    pullSecret: {{ registry.pullSecret }}
    imagePullPolicy: IfNotPresent # Default is IfNotPresent
  imageCredentials:
    pullPolicy: IfNotPresent # Default is IfNotPresent
  ## CCDM FSGROUP CONFIGURATION
  #  The next configuration defines the global fsGroup, if different configuration is needed change on purpose.
  #
  #  NOTE:
  #  - The default value 10000 for fsGroup will be used when no other value will be set.
  fsGroup:
  {% if caas == 'OpenShift' %}
    namespace: true
  {% else %}
    manual: 10000
    namespace: false # default is false
  {% endif %}
  istio:
    # UDM MESH WA: select IPv4 address or IPv6 address for IPv6 deployments
    kubernetes_service_ipaddress: {{ kubernetes_service_ipaddress }}
    # - Global INGRESS configuration
    ingress:
      gateways:
        eric-ingressgw-udr-ldap-provisioning-gw:
          ports:
            tcp-ldap-provisioning:
              enabled: false # Enable/Disable LDAP (cleartext), default is false
        eric-ingressgw-udr-ldap-traffic-gw:
          ports:
            tcp-ldap-traffic:
              enabled: false # Enable/Disable LDAP (cleartext), default is false
        # eric-ingress-udr-intersite
        # Ingress gateway for Zookeeper multisite coordination, KV Apache Geode replication, 5G Provisioning Proxy, Data Consistency Check and 4G/5G traffic for site to site communication
        eric-udr-intersite-gw:
          ports:
            tcp-ldap-proxy:
              enabled: false # Enable/Disable LDAP (cleartext), default is false
    # Global configuration for 5g INGRESS/EGRESS mTLS enabled. Remove comment symbol "#" and configure for your specific environment
            https-papi-provisioning:
              settings:
                minProtocolVersion: TLSV1_2 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                maxProtocolVersion: TLSV1_3 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                # - DHE-RSA-AES128-GCM-SHA256 not supported by istio
                # Optional: If specified, only support the specified cipher list. Otherwise default to the default cipher list supported by Envoy
                cipherSuites:
                  - ECDHE-ECDSA-AES128-GCM-SHA256
                  - ECDHE-RSA-AES128-GCM-SHA256
                #  - ECDHE-ECDSA-AES128-SHA256
                #  - ECDHE-RSA-AES128-SHA256
                  - ECDHE-ECDSA-AES256-GCM-SHA384
                  - ECDHE-RSA-AES256-GCM-SHA384
                #  - ECDHE-ECDSA-AES256-SHA384
                #  - ECDHE-RSA-AES256-SHA384
            tls-eric-udr-kvdb-ag-locators:
              settings:
                minProtocolVersion: TLSV1_2 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                maxProtocolVersion: TLSV1_3 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                # - DHE-RSA-AES128-GCM-SHA256 not supported by istio
                # Optional: If specified, only support the specified cipher list. Otherwise default to the default cipher list supported by Envoy
                cipherSuites:
                  - ECDHE-ECDSA-AES128-GCM-SHA256
                  - ECDHE-RSA-AES128-GCM-SHA256
                #  - ECDHE-ECDSA-AES128-SHA256
                #  - ECDHE-RSA-AES128-SHA256
                  - ECDHE-ECDSA-AES256-GCM-SHA384
                  - ECDHE-RSA-AES256-GCM-SHA384
                #  - ECDHE-ECDSA-AES256-SHA384
                #  - ECDHE-RSA-AES256-SHA384
            tls-eric-udr-kvdb-ag-gateway-receivers:
              settings:
                minProtocolVersion: TLSV1_2 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                maxProtocolVersion: TLSV1_3 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                # - DHE-RSA-AES128-GCM-SHA256 not supported by istio
                # Optional: If specified, only support the specified cipher list. Otherwise default to the default cipher list supported by Envoy
                cipherSuites:
                  - ECDHE-ECDSA-AES128-GCM-SHA256
                  - ECDHE-RSA-AES128-GCM-SHA256
                #  - ECDHE-ECDSA-AES128-SHA256
                #  - ECDHE-RSA-AES128-SHA256
                  - ECDHE-ECDSA-AES256-GCM-SHA384
                  - ECDHE-RSA-AES256-GCM-SHA384
                #  - ECDHE-ECDSA-AES256-SHA384
                #  - ECDHE-RSA-AES256-SHA384
            tls-eric-udr-zookeeper:
              settings:
                minProtocolVersion: TLSV1_2 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                maxProtocolVersion: TLSV1_3 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                # - DHE-RSA-AES128-GCM-SHA256 not supported by istio
                # Optional: If specified, only support the specified cipher list. Otherwise default to the default cipher list supported by Envoy
                cipherSuites:
                  - ECDHE-ECDSA-AES128-GCM-SHA256
                  - ECDHE-RSA-AES128-GCM-SHA256
                #  - ECDHE-ECDSA-AES128-SHA256
                #  - ECDHE-RSA-AES128-SHA256
                  - ECDHE-ECDSA-AES256-GCM-SHA384
                  - ECDHE-RSA-AES256-GCM-SHA384
                #  - ECDHE-ECDSA-AES256-SHA384
                #  - ECDHE-RSA-AES256-SHA384
        # eric-udr-traffic gateway configuring eric-ingressgw-udr-traffic service mesh ingress gateway
        # Ingress gateway for 5G Traffic (HTTP2) and 5G proxy multisite traffic HTTP2
        eric-udr-traffic-gw: # Gateway resource name.
          ports:
            https-mtls:
              settings:
                minProtocolVersion: TLSV1_2 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                maxProtocolVersion: TLSV1_3 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                # - DHE-RSA-AES128-GCM-SHA256 not supported by istio
                # Optional: If specified, only support the specified cipher list. Otherwise default to the default cipher list supported by Envoy
                cipherSuites:
                  - ECDHE-ECDSA-AES128-GCM-SHA256
                  - ECDHE-RSA-AES128-GCM-SHA256
                #  - ECDHE-ECDSA-AES128-SHA256
                #  - ECDHE-RSA-AES128-SHA256
                  - ECDHE-ECDSA-AES256-GCM-SHA384
                  - ECDHE-RSA-AES256-GCM-SHA384
                #  - ECDHE-ECDSA-AES256-SHA384
                #  - ECDHE-RSA-AES256-SHA384
        # Ingress gateway for 5G Provisioning (HTTP2)
        eric-eda-provisioning-gw: # Gateway resource name.
          ports:
            https-mtls:
              settings:
                minProtocolVersion: TLSV1_2 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                maxProtocolVersion: TLSV1_3 # Values allowed [ TLSV1_1, TLSV1_2, TLSV1_3 ]
                # - DHE-RSA-AES128-GCM-SHA256 not supported by istio
                # Optional: If specified, only support the specified cipher list. Otherwise default to the default cipher list supported by Envoy
                cipherSuites:
                  - ECDHE-ECDSA-AES128-GCM-SHA256
                  - ECDHE-RSA-AES128-GCM-SHA256
                #  - ECDHE-ECDSA-AES128-SHA256
                #  - ECDHE-RSA-AES128-SHA256
                  - ECDHE-ECDSA-AES256-GCM-SHA384
                  - ECDHE-RSA-AES256-GCM-SHA384
                #  - ECDHE-ECDSA-AES256-SHA384
                #  - ECDHE-RSA-AES256-SHA384

    egress:
      # - CCDM egress endpoints
      endpoints:
        # EGRESS CCDM ENDPOINTS TO BE DEFINED
        # - Egress individual rules, one per CCDM peer.
        # -- CCSM, Nudm interface notifications
        eric-ccsm-sbi-traffic-mtls:
          enabled: false
           {%- raw %}
#          host: {{EGRESS-CCSM-HOST}}
#          addresses:
#            - {{EGRESS-CCSM-VIP}}
#          ports:
#            http2-port-for-mTLS-origination:
#              maxProtocolVersion: {{EGRESS-CCSM-MAXTLS}} # Values allowed [ TLSv1_2, TLSv1_3 ]
           {% endraw %}
        # -- CCPC, Npcf interface notifications
        eric-ccpc-sbi-traffic-mtls:
          enabled: false
           {%- raw %}
#          host: {{EGRESS-CCPC-HOST}}
#          addresses:
#            - {{EGRESS-CCPC-VIP}}
#          ports:
#            http2-port-for-mTLS-origination:
#              maxProtocolVersion: {{EGRESS-CCPC-MAXTLS}} # Values allowed [ TLSv1_2, TLSv1_3 ]
           {% endraw %}
        # -- CCRC, Nnr interface NRF registration/notifications
        eric-ccrc-sbi-traffic-mtls:
          enabled: false
           {%- raw %}
#          host: {{EGRESS-CCRC-HOST}}
#          addresses:
#            - {{EGRESS-CCRC-VIP}}
#          ports:
#            http2-port-for-mTLS-origination:
#              maxProtocolVersion: {{EGRESS-CCRC-MAXTLS}} # Values allowed [ TLSv1_2, TLSv1_3 ]
           {% endraw %}
        # -- CCxx wildcard, if EGRESS-WILDCARD enabled EGRESS-CCSM-ENABLED, EGRESS-CCRC-ENABLED and EGRESS-CCPC must be disabled.
        eric-wildcard-sbi-traffic-mtls:
          enabled: true
          host: "*.{{ DOMAIN_3GPP_5GC }}"
          ports:
            http2-port-for-mTLS-origination:
              maxProtocolVersion: TLSv1_3 # Values allowed [ TLSv1_2, TLSv1_3 ]
{%- raw %}
#
#        # -- List of new remote endpoints where (m)TLS is enabled and it's not covered in the current list. Remove '# ' for enabling the element in the list. Repeat element format for more remote endpoints.
#        # Examples: New CCSM/CCPC/CCRC destinations where wildcard can not be used for identifying multiple destinations .
#        # <endpoint name>: # Free name but be careful that there has not been set previously.
#        #   enabled: {{true}} # Enable/Disable the service entry, values allowed [true, false].
#        #   host: "{{new.5gc.mnc310.mcc014.3gppnetwork.org}}" # FQDN or wildcard for new endpoint (it should not be defined before).
#        #   addresses: # Addresses is an optional field and it's only required for intersite, meaning communication among CCDM sites. Other destination should not define the address field.
#        #     - {{127.0.0.1}} # VIP resolution from host defined in the "host" parameter.
#        #   ports: # list of ports for the destination where mtls is required.
#        #   - port: {{443}} # Port number.
#        #     name: {{<protocol>-<port name>}} # For instance, https-newendpoint
#        #     protocol: {{TCP}}
#        #     maxProtocolVersion: "{{TLSv1_3}}" # Values allowed [ TLSv1_2, TLSv1_3 ]
#        #     mode: {{mTLS}}
#        #   resolution: {{NONE}}
#End of Global configuration for 5g INGRESS/EGRESS mTLS enabled
{% endraw %}

  # Prov Funct global parameters
  activation:
    # ip protocol stack mode ipv6: true or false
    ipv6: false

  # nodeSelector spec value
  nodeSelector: {}

networkPolicy:
  # default value should be set to "true"
  enabled: true

eric-nrfagent:
  global:
    # ip protocol stack mode ipv6: ipv4 or ipv6
    ipStackMode: "ipv4"


# Provisioning Function
eric-act-ccdm:
  eric-act-proclog-cassandra-stasher:
    replicaCount:
      proclogStasher: 1
  eric-act-mapi-provisioning:
    misc:
      replicaCount: 3
  eric-act-user-data-activator:
    uda:
      misc:
        replicaCount: 3
    uds:
      misc:
        synchronizerCount: 2
  eric-act-oauth-token-validator:
    misc:
      replicaCount: 2
  eric-data-wide-column-database-cd:
    persistence:
      dataVolume:
        persistentVolumeClaim:
          storageClassName: {{ storageClassName }}
          size: {{ ((pvcSize['eric-data-wide-column-database-cd']/1.07374)|round(0, 'ceil'))|int }}Gi # {32G} #Value of this parameter is result of dimensioning exercise
    # ip protocol stack mode ipv6: true or false
    resources:
      cassandra:
        network:
          useIPv6: false
    replicaCount: 3
  eric-act-mb-kf:
    persistence:
      persistentVolumeClaim:
        storageClassName: {{ storageClassName }}
        size: {{ ((pvcSize['eric-act-mb-kf']/1.07374)|round(0, 'ceil'))|int }}Gi  # {20Gi} # same value for all deployments
    replicaCount: 4
# ADP common components
eric-adp:
  eric-si-application-sys-info-handler:
    asih:
      applicationId: {{ nodeName }}
    applicationInfoService:
      port: 9099 #Default Value
{%- raw %}
#   FOR EGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#    egress:
#      applicationInfoSvr:
#        dscp: {{dscp_value}} #Optional Parameter
{% endraw %}
  eric-data-document-database-pg:
    persistentVolumeClaim:
      storageClassName: {{ storageClassName }}

  eric-data-coordinator-zk:
    replicas: 3
    persistence:
      persistentVolumeClaim:
        storageClassName: {{ storageClassName }}

  eric-pm-bulk-reporter:
    userConfig:
      ldap:
        useIPv6DNSFirst: false #true if using IPv6 stack mode
    service:
{%- raw %}
#     FOR EGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#      pmBulksftpPort:
#        dscp: {{dscp_value}}
{% endraw %}
      annotations:
        sharedVIPLabel: ccdm-oam
        addressPoolName: ccdm{{ instance }}-oam
        #cloudProviderLB:
          ##list of cloud provider annotations. Example AWS annotation
          #service.beta.kubernetes.io/aws-load-balancer-type: "external"
    persistentVolumeClaim:
      storageClassName: {{ storageClassName }}
    env:
      # nf_node_type, one of: NRF,UDM-AUSF,UDR,NSSF,5G_UDM (All the NFs within the same cluster)
      nodeType: 5G_UDM
      supportedGps: fifteen-min thirty-min one-hour twelve-hour one-day one-min five-min

  eric-data-search-engine:
    persistence:
      data:
        persistentVolumeClaim:
          storageClassName: {{ storageClassName }}
      master:
        persistentVolumeClaim:
          storageClassName: {{ storageClassName }}
    # ip protocol stack mode ipv6: true or false
    service:
      network:
        protocol:
          IPv6: false
    {% if systemProfile == 'standard' %}
    # Number of replicas for Search Engine.
    replicaCount:
    # Number of replicas for eric-data-search-engine-data container. This parameter is applicable to CCDM Standard and CCDM Large system configurations ONLY. Please, do not include this parameter for CCDM Small system configurations.
    # Value of this parameter is result of a dimensioning exercise.
      data: {{ replicaCount['eric-data-search-engine-data'] }}
    {%- raw %}
    # Number of replicas for eric-data-search-engine-ingest/eric-data-search-engine-ingest-tls containers. This parameter is applicable to CCDM Large system configurations ONLY. Please, do not include this parameter for CCDM Small or Standard system configurations.
    # Value of this parameter is result of a dimensioning exercise.
    #  ingest: {{search_engine_ingest_replicas}}
    {% endraw %}

    # Index Management configuration for Search Engine in CCDM Standard and CCDM Large system configurations only (do not include this parameter for CCDM Small system configurations).
    # Value of this parameter is result of a dimensioning exercise.

    index_management:
      delete_indices_by_diskspace:
      - index: adp-app-logs-*
        size: {{ ccdm.indexManagement['eric-data-search-engine-adp-app-logs'] }}gb
      - index: adp-app-debug-logs-*
        size: {{ ccdm.indexManagement['eric-data-search-engine-adp-app-debug-logs'] }}gb
    {% else %}
    {%- raw %}
    # Number of replicas for Search Engine.
    #replicaCount:
    # Number of replicas for eric-data-search-engine-data container. This parameter is applicable to CCDM Standard and CCDM Large system configurations ONLY. Please, do not include this parameter for CCDM Small system configurations.
    # Value of this parameter is result of a dimensioning exercise.
    #  data: {{search_engine_data_replicas}}
    # Number of replicas for eric-data-search-engine-ingest/eric-data-search-engine-ingest-tls containers. This parameter is applicable to CCDM Large system configurations ONLY. Please, do not include this parameter for CCDM Small or Standard system configurations.
    # Value of this parameter is result of a dimensioning exercise.
    #  ingest: {{search_engine_ingest_replicas}}

    # Index Management configuration for Search Engine in CCDM Standard and CCDM Large system configurations only (do not include this parameter for CCDM Small system configurations).
    # Value of this parameter is result of a dimensioning exercise.

    #index_management:
    #  delete_indices_by_diskspace:
    #  - index: adp-app-logs-*
    #    size: {{size_adp_app_logs}}gb
    #  - index: adp-app-debug-logs-*
    #    size: {{size_adp_app_debug_logs}}gb
    {% endraw %}
    {% endif %}

  eric-sec-ldap-server:
    persistentVolumeClaim:
      storageClassName: {{ storageClassName }}

  eric-cnom-server:
    fqdn: {{ cnom.fqdn }}
    legalNotice: "IF YOU ARE NOT AN AUTHORIZED USER, PLEASE EXIT IMMEDIATELY\n\nThis system processes personal information. Handle personal information with care. Misuse, including unauthorized access, is grounds for legal action. Version: 1.0, Date: October 27, 2020."

  eric-data-distributed-coordinator-ed:
    persistence:
      persistentVolumeClaim:
        storageClassName: {{ storageClassName }}
      brAgent:
        backupVolume:
          storageClassName: {{ storageClassName }}
    {% if caas == 'OpenShift' %}
    # IA35412
    resources:
      metricsexporter:
        limits:
          memory: "64Mi"
    {% endif %}

  eric-cm-yang-provider:
    externalTls:
      netconf:
        enabled: false # default value is false
    service:
{%- raw %}
#     FOR EGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#      cmNbiPorts:
#        dscp: {{dscp_value}}
{% endraw %}
      annotations:
        sharedVIPLabel: ccdm-oam
        addressPoolName: ccdm{{ instance }}-oam
        #cloudProviderLB:
          ##list of cloud provider annotations. Example AWS annotation
          #service.beta.kubernetes.io/aws-load-balancer-type: "external"
    ldap:
      ipv6Enabled: false
    persistentVolumeClaim:
      storageClassName: {{ storageClassName }}
    {%- raw %}
    #newLinesInBinaryBase64Enabled: {{true|false}}
    {% endraw %}

  eric-ctrl-bro:
{%- raw %}
#   FOR EGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#    egress:
#      backupStorageSvr:
#        dscp: {{dscp_value}}
{% endraw %}
    persistence:
      persistentVolumeClaim:
        size: {{ ((pvcSize['eric-ctrl-bro']/1.07374)|round(0, 'ceil'))|int }}Gi  # {4Gi|64Gi|256Gi} #{small-system value|standard-system value|large-system value}
        storageClassName: {{ storageClassName }}

  eric-fh-snmp-alarm-provider:
    service:
{%- raw %}
#   FOR EGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#      snmpPort:
#        dscp: {{dscp_value}}
{% endraw %}
      annotations:
        sharedVIPLabel: ccdm-oam
        addressPoolName: ccdm{{ instance }}-oam
        #cloudProviderLB:
          ##list of cloud provider annotations. Example AWS annotation
          #service.beta.kubernetes.io/aws-load-balancer-type: "external"
    # Needs to be configured when integrating CCDM with ENM FM using SNMPv2c sourceIdentifier.
    # Requires ENM 22.1 (sprint 22.02)
    # Possible values are 0(Unknown), 1(IPV4), 2(IPV6)
    sourceIdentifierType: 1
    # Needs to be configured when integrating CCDM with ENM FM using SNMPv2c sourceIdentifier.
    # Should be in IPv4 or IPv6 format, depending on SourceIdentifierType
    {% if caas != 'OpenShift' %}
    sourceIdentifier: {{ snmp.sourceIdentifier }}
    {% endif %}
{%- raw %}
#  eric-lm-combined-server:
#   FOR EGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#    egress:
#      licenseServer:
#        dscp: {{dscp_value}}
{% endraw %}

  eric-pm-server:
    rbac:
      appMonitoring:
        {% if caas == 'OpenShift' %}
        enabled: false
        {% else %}
        enabled: true
        {% endif %}
        federation:
          jobOverride: true
          jobConfiguration: |
            - job_name: 'federate-victoria'
              scrape_interval: 1m
              honor_labels: true
              metrics_path: '/select/0/prometheus/federate'
              params:
                'match[]':
                  - '{job="kubernetes-nodes",namespace="{{ vnflcm.namespace }}"}'
                  - '{job="kubernetes-nodes-cadvisor",namespace="{{ vnflcm.namespace }}"}'
              static_configs:
                - targets:
                  - 'eric-victoria-metrics-cluster-vmselect.monitoring:8481'
    server:
      extraArgs:
        storage.tsdb.retention.size: {{ ((pvcSize['eric-pm-server']*0.85)) }}GB # {13GB|30GB|30GB} #These are default values for small-system, standard-system and large-system but value of this parameter should be set to 85% of eric-adp.eric-pm-server.server.persistentVolume.size
      persistentVolume:
        storageClass: {{ storageClassName }}
        size: {{ ((pvcSize['eric-pm-server']/1.07374)|round(0, 'ceil'))|int }}Gi # {16Gi|35Gi|35Gi}  #These are default values for small-system, standard-system and large-system but the exact value for this parameter is result of dimensioning exercise
   {%- raw %}
    #config:
    #  certm_tls:
    #    - name: remotewrite1
    #      trustedCertName: remotewrite1-ca
    #      clientKeyName: remotewrite1-client-key
    #      clientCertName: remotewrite1-client-certificate
    # externalRemoteWrite: [] #When configuring externalRemoteWrite endpoints the brackets [] must be removed otherwise configuration will not be taken into effect
      # - url: {{enpoint_url}}
      #   tls_config:
      #     ca_file: /run/secrets/remwrtca/remotewrite1/cert1.pem
      #     cert_file: /run/secrets/remwrtcert/remotewrite1/tls.crt
      #     key_file: /run/secrets/remwrtcert/remotewrite1/tls.key
      #   queue_config:
      #     capacity: 2500
      #     max_shards: 200
      #     min_shards: 1
      #     max_samples_per_send: 500
      #     batch_send_deadline: 5s
      #     min_backoff: 30ms
      #     max_backoff: 100ms
      #   write_relabel_configs:
      # Depending on the metrics wanted to be streamed outside uncomment ONE of filtering options below:
          # To stream all metrics from UDR, PF, NRF Agent and PM Resource monitor services uncomment following block. Note: Recommended configuration.
          # - source_labels: [__name__]
      #       regex: 'eric_udr_.*| eric_act_.*| eric_nrfagent_.*| pmrm_container_.*'
      #       action: keep
          # To stream all metrics from UDR, PF, NRF Agent and ADP services ucomment following blocks. ATTENTION: ADP services generate lot of metrics and streaming them all can have impact on PM Server performance.
      #     - source_labels: [job]
      #       regex: 'kubernetes-.*'
      #       action: drop
      #     - source_labels: [ddc_job]
      #       regex: 'kubernetes-.*'
      #       action: drop
      #     - source_labels: [scrape_job]
      #       regex: 'kubernetes-.*'
      #       action: drop
    {% endraw %}

  eric-tm-ingress-controller-cr:
    service:
      annotations:
        sharedVIPLabel: ccdm-oam
        addressPoolName: ccdm{{ instance }}-oam
        #cloudProviderLB:
          ##list of cloud provider annotations. Example AWS annotation
          #service.beta.kubernetes.io/aws-load-balancer-type: "external"
  eric-log-transformer:
    # Number of replicas for eric-log-transformer. This parameter is applicable to CCDM Standard and CCDM Large system configurations ONLY. Please, do not include this parameter for CCDM Small system configurations.
    # Value of this parameter is result of a dimensioning exercise.
    {% raw %}
    #replicaCount: {{log_transformer_replicas}}
    {% endraw %}
    egress:
      syslog:
        ##FOR CLEARTEXT, REMOVE COMMENT
        #tls:
        #  enabled: false
        ##Only it is needed to be modified in case of the Certificates have been modified by customer. Remove comment and assign new certificate names
        ##certificates:
        ##  asymmetricKeyCertificateName: eric-log-transformer-client-certificate
        ##  trustedCertificateListName: eric-log-transformer-cacerts
        enabled: false
        remoteHosts:
          - host:
            port:
        ## Remove # characters to enable inclusion rule.
        ## If this inclusion rule is enabled, only the log events with facility field set to "security/authorization messages" will be sent to syslog receiver.
        ##inclusions:
        ##  - field: "[facility]"
        ##    value: "security/authorization messages"
      lumberjack:
        enabled: false #Default is false
        {%- raw %}
        #Array to specify the mandatory parameters (id, host, port and codec) and optional parameters (inclusions, exclusions and filter), for every remote host.
        remoteHosts: [] #When configuring remoteHosts the brackets [] must be removed otherwise configuration will not be taken into effect
        #  - id: ext-lj-1
        #    host: {{hostname}}
        #    port: {{port_number}}
        #    codec: json
        #    inclusions:
        #      - field: "[facility]"
        #        value: "log audit"
        #      - field: "[metadata][category]"
        #        pattern: 'privacy*'
        #    exclusions:
        #      - logplane:
        #        rules:
        #          - field: "[facility]"
        #            value: "security"
        #          - field: "[severity]"
        #            value: "error"
        #  - id: ext-lj-2
        #    host: {{hostname}}
        #    port: {{port_number}}
        #    codec: json
        #    filter: #|
        # Only it is needed to be modified in case of the Certificates have been modified by customer. Remove comment and assign new certificate names
        #certificates:
        #  trustedCertificateListName: {{eric-log-lumberjack-client}}
        {% endraw %}

  eric-sec-access-mgmt:
    service:
      ipv6:
        enabled: false

  eric-data-object-storage-mn:
    affinity:
      podAntiAffinity: "hard" #default is hard
    persistentVolumeClaim:
      storageClassName: {{ storageClassName }}

  eric-probe-virtual-tap-broker:
    replicaCount: 4

  eric-log-shipper:
    podPriority:
      logshipper:
        # Priority class name for the logshipper Pod. Priority classes are used to determine the priority of Pods when scheduling them on nodes.
        priorityClassName: eric-ccdm-critical
    {% if caas == 'OpenShift' %}
    rbac:
      automountServiceAccountToken: true
      createClusterRole: true
      createClusterRoleBinding: true
    logshipper:
      privileged: true
      cfgData: ""
      autodiscover:
        enabled: true
        namespace: ".RELEASE.NAMESPACE"
        logplane: adp-app-logs
        hints:
          enabled: false
        paths:
          - /var/log/pods/${data.kubernetes.namespace}_${data.kubernetes.pod.name}_${data.kubernetes.pod.uid}/**/*.log
        useContainerInput: true
    additionalVolumes: |
      - name: crio-containers
        hostPath:
          path: /var/log/containers
      - name: kubernetes-containers
        hostPath:
          path: /var/log/pods
    additionalVolumeMounts: |
      - name: crio-containers
        mountPath: /var/log/containers
        readOnly: true
      - name: kubernetes-containers
        mountPath: /var/log/pods
        readOnly: true
    {% endif %}

#TBD
# Storage Encryption Provider (SEP) - PV encryption support service configuration
# SEP deployment: eric-cs-storage-encryption-provider
eric-cs-storage-encryption-provider:
  enabled: false #Enable/Disable SEP deployment, when disabled the storageClasses parameters are not applicable.
{%- raw %}
# Remove and configure the SEP following storageClasses definition only when eric-cs-storage-encryption-provider.enabled=true
#  storageClasses:
#    - name: {{pvc_storage_encrypted}} #Name of the storageClass to be created by SEP for encrypting volumes. This name must be unique in the K8 cluster, as naming convention example ccdm-instanceId-encrypted-sc.
#      backingStorageClass: {{pvc_storage}} #StorageClass defined in the cluster used for non-encrypted volumes.
#      allowVolumeExpansion: {{true|false}} # Depends on the backingStorageClass support, if it is not supported the value must be false.
#      backingVolumeMode: Block #Backing-volume mode must be Block. Filesystem is not supported.
# Remove the comment and configure the SEP podPriority only when eric-cs-storage-encryption-provider.enabled=true
#  podPriority:
#    node:
#      priorityClassName: {{eric-ccdm-critical}}
#    controller:
#      priorityClassName: {{eric-ccdm-critical}}
#    mountTarget:
#      priorityClassName: {{eric-ccdm-critical}}
# Application helm hooks activation when SEP is deployed
{% endraw %}
sepLcmHelmHooks:
  enabled: false #true when SEP is enabled: eric-cs-storage-encryption-provider.enabled=true
# Storage Encryption Provider (SEP) - End
#END TBD
# eric-udr-release
eric-udr:
{%- raw %}
#  FOR EGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#  global:
#    envoy:
#      egress:
#        5g-traffic:
#          dscp: {{5g-traffic_dscp_value}}
#        4g-traffic:
#          dscp: {{4g-traffic_dscp_value}}
#        system-monitor:
#          dscp: {{system-monitor_dscp_value}}
#        kvdb:
#          dscp: {{kvdb_dscp_value}}
{% endraw %}
  # eric-udr-message-bus-kf:
  eric-data-message-bus-kf:
    persistence:
      persistentVolumeClaim:
        storageClassName: {{ storageClassName }}

  eric-udr-prov-sync-fe:
    maxReplica: {{ hpaReplica['eric-udr-prov-sync-fe'].max }} #{10|100|100} #small-system | std-system values | large system values. Value is result of a dimensioning exercise
    minReplica: {{ hpaReplica['eric-udr-prov-sync-fe'].min }} #{2|2|2} #small-system | std-system values | large system values. Value is result of a dimensioning exercise

  eric-udr-backuprestore:
    persistence:
      storageClass: {{ storageClassName }}

  eric-udr-ldap-balancer:
    deploy:
      minReplica: {{ hpaReplica['eric-udr-ldap-balancer'].min }} #{2|6|6} #{small-system value|standard-system value|large-system value}
      maxReplica: {{ hpaReplica['eric-udr-ldap-balancer'].max }} #{2|6|6} #{small-system value|standard-system value|large-system value}

  eric-udr-ldapfe:
    service:
      minReplica: {{ hpaReplica['eric-udr-ldapfe'].min }} #{2}
      maxReplica: {{ hpaReplica['eric-udr-ldapfe'].max }} #{10|100|100} #{small-system value|standard-system value|large-system value}

  eric-udr-nudrsvc:
    minReplica: {{ hpaReplica['eric-udr-nudrfe'].min }} #{2}
    maxReplica: {{ hpaReplica['eric-udr-nudrfe'].max }} #{10|100|100} #{small-system value|standard-system value|large-system value}

  eric-udr-provisioningfe:
    minReplica: {{ hpaReplica['eric-udr-provisioningfe'].min }} #{2}
    maxReplica: {{ hpaReplica['eric-udr-provisioningfe'].max }} #{10|100|100} #{small-system value|standard-system value|large-system value}

  eric-udr-rest-notifchecker:
    minReplica: {{ hpaReplica['eric-udr-rest-notifchecker'].min }} #{2}
    maxReplica: {{ hpaReplica['eric-udr-rest-notifchecker'].max }} #{10|100|100} #{small-system value|standard-system value|large-system value}

  eric-udr-rest-notifsender:
    minReplica: {{ hpaReplica['eric-udr-rest-notifsender'].min }} #{2}
    maxReplica: {{ hpaReplica['eric-udr-rest-notifsender'].max }} #{10|100|100} #{small-system value|standard-system value|large-system value}

  eric-udr-soap-notifchecker:
    minReplica: {{ hpaReplica['eric-udr-soap-notifchecker'].min }} #{2}
    maxReplica: {{ hpaReplica['eric-udr-soap-notifchecker'].max }} #{10|100|100} #{small-system value|standard-system value|large-system value}

  eric-udr-soap-notifsender:
    minReplica: {{ hpaReplica['eric-udr-soap-notifsender'].min }} #{2}
    maxReplica: {{ hpaReplica['eric-udr-soap-notifsender'].max }} #{10|100|100} #{small-system value|standard-system value|large-system value}

  eric-udr-notificationsubscription:
    minReplica: {{ hpaReplica['eric-udr-notificationsubscription'].min }} #{2}
    maxReplica: {{ hpaReplica['eric-udr-notificationsubscription'].max }} #{10|100|100} #{small-system value|standard-system value|large-system value}
    app:
      periodicMaintenance:
        # app.periodicMaintenance.cleanupSchedule -- Cron expression for execution of cleanup of deleted + expired entries. Daily at 01:00 AM by default. Fields: second minute hour day-of-the-month month day-of-the-week *=any ?=no specific value ,=value list separator
        cleanupSchedule: "0 0 1 * * ?"
        # app.periodicMaintenance.timeDeletedHoursBeforeEntryCleanup -- Time in hours that a notification subscription entry must have been deleted before it is eligible for permanent removal. 24 h by default
        timeDeletedHoursBeforeEntryCleanup: 24
  eric-udr-gudrestfe:
    minReplica: {{ hpaReplica['eric-udr-gudrestfe'].min }} #{2}
    maxReplica: {{ hpaReplica['eric-udr-gudrestfe'].max }} #{10|100|100} #{small-system value|standard-system value|large-system value}
    # Set to "true" to enable ngud gudrestfe virtual service, see section "REST-based Ud Interface Configuration" in CCDM CPI for detail.
    istio:
      virtualservice:
        enabled: true

eric-data-kvdb-ag:
  persistence:
    data:
      persistentVolumeClaim:
        storageClassName: {{ storageClassName }}
    gwsender:
      persistentVolumeClaim:
        storageClassName: {{ storageClassName }}
    backup:
      persistentVolumeClaim:
        storageClassName: {{ storageClassName }}
  multiSite:
    locator:
      localHost: {{ ccdm.udr.geored.local.host }}.{{ DOMAIN_3GPP_5GC }}
  replicaCount:
    server: {{ replicaCount['eric-udr-kvdb-ag-server'] }} #{4}
  podPriority:
    locator:
      priorityClassName: eric-ccdm-critical
    server:
      priorityClassName: eric-ccdm-critical
################################################################################
# eric-ccdm-service-mesh
################################################################################
eric-udm-mesh-integration:
  eric-ingressgw-udr-traffic:
{%- raw %}
#  FOR INGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#  NOTE: Only remove the comment in front of "dscpDualStack: true" line in case of running on a dual-stack kubernetes cluster. Value must be always set to true
#    dscpDualStack: true
#    ports:
#      http2-clear:
#        dscp: {{dscp_value}}
#      https-mtls:
#        dscp: {{dscp_value}}
{% endraw %}
    replicaCount: {{ replicaCount['eric-ingressgw-udr-traffic'] }} #{2|12|18} #{small-system value|standard-system value|large-system value}
    externalTrafficPolicy: "Local"
    service:
      annotations:
        addressPoolName: ccdm{{ instance }}-5g-traffic
        # If defined due to addressPoolName is shared by more than one eric-ingressgw deployment,
        # set externalTrafficPolicy to Cluster
        sharedVIPLabel: ccdm-5g-traffic
        #cloudProviderLB:
          ##list of cloud provider annotations. Example AWS annotation
          #service.beta.kubernetes.io/aws-load-balancer-type: "external"
  eric-ingressgw-eda-provisioning:
{%- raw %}
#  FOR INGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#  NOTE: Only remove the comment in front of "dscpDualStack: true" line in case of running on a dual-stack kubernetes cluster. Value must be always set to true
#    dscpDualStack: true
#    ports:
#      http2-clear:
#        dscp: {{dscp_value}}
#      https-mtls:
#        dscp: {{dscp_value}}
{% endraw %}
    replicaCount: {{ replicaCount['eric-ingressgw-eda-provisioning'] }} #{2|6|6} #{small-system value|standard-system value|large-system value}
    externalTrafficPolicy: "Local"
    service:
      annotations:
        addressPoolName: ccdm{{ instance }}-5g-prov
        # If defined due to addressPoolName is shared by more than one eric-ingressgw deployment,
        # set externalTrafficPolicy to Cluster
        sharedVIPLabel: ccdm-5g-prov
        #cloudProviderLB:
          ##list of cloud provider annotations. Example AWS annotation
          #service.beta.kubernetes.io/aws-load-balancer-type: "external"
  eric-ingressgw-udr-ldap-provisioning:
{%- raw %}
#  FOR INGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#  NOTE: Only remove the comment in front of "dscpDualStack: true" line in case of running on a dual-stack kubernetes cluster. Value must be always set to true
#    dscpDualStack: true
#    ports:
#      tcp-ldap:
#        dscp: {{dscp_value}}
#      tls-ldap:
#        dscp: {{dscp_value}}
{% endraw %}
    replicaCount: {{ replicaCount['eric-ingressgw-udr-ldap-provisioning'] }} #{2|8|8} #{small-system value|standard-system value|large-system value}
    externalTrafficPolicy: "Local"
    service:
      annotations:
        addressPoolName: ccdm{{ instance }}-4g-prov
        # If defined due to addressPoolName is shared by more than one eric-ingressgw deployment,
        # set externalTrafficPolicy to Cluster
        sharedVIPLabel: ccdm-4g-prov
        #cloudProviderLB:
          ##list of cloud provider annotations. Example AWS annotation
          #service.beta.kubernetes.io/aws-load-balancer-type: "external"
  eric-ingressgw-udr-ldap-traffic:
{%- raw %}
#  FOR INGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#  NOTE: Only remove the comment in front of "dscpDualStack: true" line in case of running on a dual-stack kubernetes cluster. Value must be always set to true
#    dscpDualStack: true
#    ports:
#      tcp-ldap:
#        dscp: {{dscp_value}}
#      tls-ldap:
#        dscp: {{dscp_value}}
{% endraw %}
    replicaCount: {{ replicaCount['eric-ingressgw-udr-ldap-traffic'] }} #{2|12|12} #{small-system value|standard-system value|large-system value}
    externalTrafficPolicy: "Local"
    service:
      annotations:
        addressPoolName: ccdm{{ instance }}-4g-traffic
        # If defined due to addressPoolName is shared by more than one eric-ingressgw deployment,
        # set externalTrafficPolicy to Cluster
        sharedVIPLabel: ccdm-4g-traffic
        #cloudProviderLB:
          ##list of cloud provider annotations. Example AWS annotation
          #service.beta.kubernetes.io/aws-load-balancer-type: "external"
  eric-ingressgw-udr-intersite:
{%- raw %}
#  FOR INGRESS DSCP MARKING, REMOVE COMMENT AND ADD DESIRED DSCP VALUE
#  NOTE: Only remove the comment in front of "dscpDualStack: true" line in case of running on a dual-stack kubernetes cluster. Value must be always set to true
#    dscpDualStack: true
#    ports:
#      http2-clear:
#        dscp: {{dscp_value}}
#      https-mtls:
#        dscp: {{dscp_value}}
#      tcp-kvdb-loc:
#        dscp: {{dscp_value}}
#      tcp-kvdb-recv:
#        dscp: {{dscp_value}}
#      tcp-zookeeper:
#        dscp: {{dscp_value}}
#      tcp-ldap-proxy:
#        dscp: {{dscp_value}}
#      tls-ldap-proxy:
#        dscp: {{dscp_value}}
{% endraw %}
    replicaCount: {{ replicaCount['eric-ingressgw-udr-intersite'] }} #{2|10|12} #{small-system value|standard-system value|large-system value}
    externalTrafficPolicy: "Local"
    service:
      annotations:
        addressPoolName: ccdm{{ instance }}-intersite
        # If defined due to addressPoolName is shared by more than one eric-ingressgw deployment,
        # set externalTrafficPolicy to Cluster
        sharedVIPLabel: ccdm-intersite
        #cloudProviderLB:
          ##list of cloud provider annotations. Example AWS annotation
          #service.beta.kubernetes.io/aws-load-balancer-type: "external"
